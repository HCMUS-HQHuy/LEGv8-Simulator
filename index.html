<!DOCTYPE html>
<html>
<head>
<title> LEGv8 Visual Simulator - HCMUS </title>
<link rel = "stylesheet" href = "Styles/styles.css">
<link rel = "stylesheet" href = "Styles/animation-styles.css">
<link rel="icon" type="image/png" href="hcmus_logo.png">
</head>
<body>

<div class="header">
  <h2>LEGv8 Visual Simulator</h2>

  <button id = "themeToggle">üîÜ Light Mode</button>
</div>

<div class = "codeAndFrameContainer">
  <div class = "frameBox">
    <h2>Frame</h2>

    <div class = "frame" id = "zoomFrame">
      <svg viewBox = "0 0 1800 1050">
      <g class = "content" id = "zoomContent">
        <!-- Signal Lines Layer -->
        <g id = "signal-lines">
          <defs>
            <marker id = "circle" markerWidth = "8" markerHeight = "8" refX = "5" refY = "5">
              <circle cx = "5" cy = "5" r = "2" fill = "context-stroke" />
            </marker>
            <marker id = "arrow" markerWidth = "4" markerHeight = "4" refX = "2" refY = "2" orient = "auto">
              <path d = "M0,0 L4,2 L0,4 z" fill = "context-stroke" />
            </marker>
          </defs>

          <!-- ƒê∆∞·ªùng ƒëi th·∫≠t ƒë·ªÉ d√πng cho animation -->
          <!-- pc -->
          <path id         = "pc-to-instruction-memory-path" 
                d          = "M153,550 L282,550" 
                class      = "signal-line" 
                marker-end = "url(#arrow)" />

          <path id         = "pc-to-ALU-add-0-path" 
                d          = "M153,550 L215,550 L215,75 L292,75" 
                class      = "signal-line" 
                marker-end = "url(#arrow)" />
          <path id         = temporary-circle
                d          = "M215,550"
                class      = "signal-line"
                marker-end = "url(#circle)" />
          
          <path id         = "pc-to-ALU-add-1-path" 
                d          = "M153,550 L215,550 L215,200 L400,200 L400,150 L1270,150" 
                class      = "signal-line" 
                marker-end = "url(#arrow)" />
          <path id         = temporary-circle
                d          = "M215,200"
                class      = "signal-line"
                marker-end = "url(#circle)" />

          <!-- const 4 -->
          <path id         = "const-4-to-ALU-add-0-path" 
                d          = "M250,150 L292,150" 
                class      = "signal-line" 
                marker-end = "url(#arrow)" />

          <!-- ALU-add-id -->
          <path id         = "ALU-add-0-to-mux-0-0-path" 
                d          = "M370,120 L1572,120" 
                class      = "signal-line" 
                marker-end = "url(#arrow)" />

          <path id         = "ALU-add-1-to-mux-0-1-path" 
                d          = "M1365,200 L1575,200" 
                class      = "signal-line" 
                marker-end = "url(#arrow)" />
              
          <path id         = "ALU-add-2-to-data-memory-path"
                d          = "M1290,650 L1440,650"
                class      = "signal-line"
                marker-end = "url(#arrow)" />
          
          <path id         = "ALU-add-2-to-mux-3-0-path"
                d          = "M1290,650 L1370,650 L1370,850 L1710,850 L1710,770"
                class      = "signal-line"
                marker-end = "url(#arrow)" />
          <path id         = temporary-circle
                d          = "M1370,650"
                class      = "signal-line"
                marker-end = "url(#circle)" />
          
          <path id         = "ALU-add-2-zero-path"
                d          = "M1290,600 L1320,600 L1320,520 L1350,520"
                class      = "control-signal-line" />

          <!-- mux-id-status -->
          <path id         = "mux-0-to-pc-path" 
                d          = "M1622,160 L1650,160 L1650,30 L60,30 L60,550 L92,550" 
                class      = "signal-line" 
                marker-end = "url(#arrow)" />

          <path id         = "mux-1-to-register-path" 
                d          = "M710,600 L775,600" 
                class      = "signal-line" 
                marker-end = "url(#arrow)" />
          
          <path id         = "mux-2-to-ALU-add-2-path" 
                d          = "M1110,680 L1180,680" 
                class      = "signal-line" 
                marker-end = "url(#arrow)" />      
          
          <path id         = "mux-3-to-register-path" 
                d          = "M1730,715 L1760,715 L1760,1015 L725,1015 L725,710 L775,710" 
                class      = "signal-line" 
                marker-end = "url(#arrow)" />

          <!-- sign-extend -->
          <path id         = "sign-extend-to-shift-left-2-path" 
                d          = "M930,840 L990,840 L990,250 L1100,250" 
                class      = "signal-line" 
                marker-end = "url(#arrow)" />

          <path id         = "sign-extend-to-mux-2-1-path" 
                d          = "M930,840 L990,840 L990,710 L1060,710" 
                class      = "signal-line" 
                marker-end = "url(#arrow)" />
          <path id         = temporary-circle
                d          = "M990,710"
                class      = "signal-line"
                marker-end = "url(#circle)" />

          <!-- shift-left-2 -->
          <path id         = "shift-left-2-to-add-1-path" 
                d          = "M1190,250 L1270,250" 
                class      = "signal-line" 
                marker-end = "url(#arrow)" />

          <!-- instruction-memory -->
          <path id         = "instruction-memory-to-control-path" 
                d          = "M420,630 L490,630 L490,380 L655,380" 
                class      = "signal-line" 
                marker-end = "url(#arrow)" />
          <path id         = temporary-circle
                d          = "M490,630"
                class      = "signal-line"
                marker-end = "url(#circle)" />

          <path id         = "instruction-memory-to-read-register-1-path" 
                d          = "M420,630 L490,630 L490,540 L775,540" 
                class      = "signal-line" 
                marker-end = "url(#arrow)" />
          <path id         = temporary-circle
                d          = "M490,540"
                class      = "signal-line"
                marker-end = "url(#circle)" />

          <path id         = "instruction-memory-to-mux-1-0-path" 
                d          = "M420,630 L490,630 L490,570 L665,570" 
                class      = "signal-line" 
                marker-end = "url(#arrow)" />
          <path id         = temporary-circle
                d          = "M490,570"
                class      = "signal-line"
                marker-end = "url(#circle)" />
          
          <path id         = "instruction-memory-to-mux-1-1-path" 
                d          = "M420,630 L490,630 L490,670 L580,670 L580,640 L665,640" 
                class      = "signal-line" 
                marker-end = "url(#arrow)" />
          <path id         = temporary-circle
                d          = "M490,670"
                class      = "signal-line"
                marker-end = "url(#circle)" />
          <path id         = temporary-circle
                d          = "M580,670"
                class      = "signal-line"
                marker-end = "url(#circle)" />
                
          <path id         = "instruction-memory-to-write-register-path" 
                d          = "M420,630 L490,630 L490,670 L775,670" 
                class      = "signal-line" 
                marker-end = "url(#arrow)" />
          
          <path id         = "instruction-memory-to-sign-extend-path"
                d          = "M420,630 L490,630 L490,840 L825,840"
                class      = "signal-line"
                marker-end = "url(#arrow)" />

          <path id         = "instruction-memory-to-alu-control-path"
                d          = "M420,630 L490,630 L490,840 L750,840 L750,990 L1130,990 L1130,935"
                class      = "signal-line"
                marker-end = "url(#arrow)" />
          <path id         = temporary-circle
                d          = "M750,840"
                class      = "signal-line"
                marker-end = "url(#circle)" />

          <!-- register -->
          <path id         = "register-to-mux-2-0-path"
                d          = "M950,650 L1060,650"
                class      = "signal-line"
                marker-end = "url(#arrow)" />
          
          <path id         = "register-to-ALU-add-2-path"
                d          = "M950,560 L1180,560"
                class      = "signal-line"
                marker-end = "url(#arrow)" />
          
          <path id         = "register-to-data-memory-path"
                d          = "M950,650 L1020,650 L1020,770 L1440,770"
                class      = "signal-line"
                marker-end = "url(#arrow)" />
          <path id         = temporary-circle
                d          = "M1020,650"
                class      = "signal-line"
                marker-end = "url(#circle)" />

          <!-- data-memory -->
          <path id         = "data-memory-to-mux-3-1-path"
                d          = "M1590,680 L1680,680"
                class      = "signal-line"
                marker-end = "url(#arrow)" />

          <!-- control -->
          <path id         = "control-reg2loc-path"
                d          = "M730,275 L770,275 L770,230 L450,230 L450,750 L690,750 L690,655"
                class      = "control-signal-line" />

          <path id         = "control-uncondbranch-path"
                d          = "M730,300 L1400,300 L1400,260 L1490,260"
                class      = "control-signal-line" />

          <path id         = "control-branch-path"
                d          = "M730,325 L1320,325 L1320,480 L1350,480"
                class      = "control-signal-line" />

          <path id         = "control-memread-path"
                d          = "M730,350 L1640,350 L1640,870 L1520,870 L1520,810"
                class      = "control-signal-line" />

          <path id         = "control-memtoreg-path"
                d          = "M730,375 L1710,375 L1710,665"
                class      = "control-signal-line" />

          <path id         = "control-aluop-path"
                d          = "M730,400 L1005,400 L1005,860 L1080,860"
                class      = "ALU-control-signal-line" />

          <path id         = "control-memwrite-path"
                d          = "M730,425 L1520,425 L1520,610"
                class      = "control-signal-line" />

          <path id         = "control-alusrc-path"
                d          = "M730,450 L1090,450 L1090,630"
                class      = "control-signal-line" />

          <path id         = "control-regwrite-path"
                d          = "M730,475 L870,475 L870,520"
                class      = "control-signal-line" />

          <!-- ALU-control -->
          <path id         = "ALU-control-to-ALU-2-path"
                d          = "M1180,860 L1250,860 L1250,685"
                class      = "ALU-control-signal-line" />

          <!-- AND gate -->
          <path id         = "AND-gate-to-OR-gate-path"
                d          = "M1430,500 L1450,500 L1450,290 L1490,290"
                class      = "control-signal-line" />

          <!-- OR gate -->
          <path id         = "OR-gate-to-mux-0-1-path"
                d          = "M1550,280 1600,280 1600,220"
                class      = "control-signal-line" />
          
          <g id="data-signal-nodes">
            <!-- C√°c node 0/1 s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y b·∫±ng JavaScript -->
          </g>

          <g id="data-signal-nodes0"></g>
          <g id="data-signal-nodes1"></g>
          <g id="data-signal-nodes2"></g>
          <g id="data-signal-nodes3"></g>
          <g id="data-signal-nodes4"></g>
          <g id="data-signal-nodes5"></g>
          <g id="data-signal-nodes6"></g>
          <g id="data-signal-nodes7"></g>
          <g id="data-signal-nodes8"></g>
          <g id="data-signal-nodes9"></g>

          

          <!-- Ch·∫•m tr√≤n di chuy·ªÉn theo ƒë∆∞·ªùng path -->
          <circle id = "point" r="5" fill="red" visibility="hidden">
            <animateMotion id = "animationDot" dur="2s" rotate="auto" fill="freeze" begin="indefinite">
              <mpath href="#pc-to-ALU-add-0-path" />
            </animateMotion>
          </circle>
        </g>

        <!-- Components Layer (Drawn AFTER lines = On Top) -->
        <g id="components">
          <!-- pc -->
          <g id="pc" transform = "translate(100, 500)">
            <rect width = "50" height = "100" class = "component" />

            <text x = "25" y = "50" class = "label"> PC </text>
            
            <text id = "pc-value-text" x = "-30" y = "125" class = "mem-control-label" font-weight = "bold"> 0x0 </text>
          </g>

          <!-- instruction-memory -->
          <g id="instruction-memory" transform = "translate(290, 530)">
            <rect width = "130" height = "200" class = "component" />

            <text x = "65" y = "165" class = "label"> Instruction </text>
            <text x = "65" y = "185" class = "label"> memory</text>
        
            <text x = "5"  y = "20"  class = "mem-label"> Read </text>
            <text x = "5"  y = "40"  class = "mem-label"> address </text>
            <text id="read-address-instruction-memory" x = "30"  y = "60" class="instruction"></text>

            <text x = "35" y = "95"  class = "mem-label"> Instruction </text> 
            <text x = "75" y = "115" class = "mem-label"> [31-0] </text> 
            
            <text x = "205" y = "-160" class = "mem-label"> Instruction [31-21] </text> 

            <text x = "205" y = "0"    class = "mem-label"> Instruction [9-5] </text> 

            <text x = "205" y = "30"   class = "mem-label"> Instruction [20-16] </text> 

            <text x = "205" y = "165"  class = "mem-label"> Instruction [4-0] </text> 

            <text x = "205" y = "300"  class = "mem-label"> Instruction [31-0] </text> 

            <text x = "465" y = "450"  class = "mem-label"> Instruction [31-21] </text> 
          </g>
          
          <!-- register  -->
          <g id="register" transform = "translate(780, 520)">
            <rect width = "170" height = "220" class = "component" />

            <text x = "115" y = "205" class = "label"> Registers </text>

            <text x = "5"   y = "20"  class = "mem-label"> Read </text>
            <text x = "5"   y = "40"  class = "mem-label"> register 1 </text>
              
            <text x = "5"   y = "75"  class = "mem-label"> Read </text>
            <text x = "5"   y = "95"  class = "mem-label"> register 2 </text>
      
            <text x = "5"   y = "145" class = "mem-label"> Write </text>
            <text x = "5"   y = "165" class = "mem-label"> register </text>
              
            <text x = "5"   y = "190" class = "mem-label"> Write </text>
            <text x = "5"   y = "210" class = "mem-label"> data </text>

            <text x = "115" y = "40"  class = "mem-label"> Read </text>
            <text x = "110" y = "60"  class = "mem-label"> data 1 </text>

            <text x = "115" y = "130" class = "mem-label"> Read </text>
            <text x = "110" y = "150" class = "mem-label"> data 2 </text>

            <text id = "register-option-value" x = "95" y = "-5" class = "mem-control-label"></text>
          </g>

          <!-- <g id="clone-register" transform = "translate(1400, 600) scale(2)">
            <rect width = "170" height = "220" class = "component" />

            <text x = "115" y = "205" class = "label"> Registers </text>

            <text x = "5"   y = "20"  class = "mem-label"> Read </text>
            <text x = "5"   y = "40"  class = "mem-label"> register 1 </text>
              
            <text x = "5"   y = "75"  class = "mem-label"> Read </text>
            <text x = "5"   y = "95"  class = "mem-label"> register 2 </text>
      
            <text x = "5"   y = "145" class = "mem-label"> Write </text>
            <text x = "5"   y = "165" class = "mem-label"> register </text>
              
            <text x = "5"   y = "190" class = "mem-label"> Write </text>
            <text x = "5"   y = "210" class = "mem-label"> data </text>

            <text x = "115" y = "40"  class = "mem-label"> Read </text>
            <text x = "110" y = "60"  class = "mem-label"> data 1 </text>

            <text x = "115" y = "130" class = "mem-label"> Read </text>
            <text x = "110" y = "150" class = "mem-label"> data 2 </text>

            <text id = "regwrite-to-register-value" x = "95" y = "-5" class = "mem-control-label">0</text>
            
            <text id="read1" x = "5" y = "60" class = "instruction">  </text>
            <text id="read2" x = "5" y = "90" class = "instruction">  </text>
            <text id="write-reg" x = "5" y = "130" class = "instruction">  </text>
            <text id="write-data" x = "5" y = "160" class = "instruction">  </text>
          </g> -->

          <!-- data-memory  -->
          <g id="data-memory" transform = "translate(1450, 610)">
            <rect width = "140" height = "200" class = "component" />

            <text x = "110" y = "165" class = "label"> Data </text>
            <text x = "90"  y = "185" class = "label"> memory </text>

            <text x = "5"   y = "45"  class = "mem-label"> Address </text>

            <text x = "5"   y = "155" class = "mem-label"> Write </text>
            <text x = "5"   y = "175" class = "mem-label"> data </text>

            <text x = "85"  y = "65"  class = "mem-label"> Read </text>
            <text x = "95"  y = "85"  class = "mem-label"> data </text>

            <text id = "data-memory-write-enable-value" x = "55" y = "-5" class = "mem-control-label"></text>
            <text id = "data-memory-read-enable-value" x = "55" y = "220" class = "mem-control-label"></text>
          </g>

          <!-- ALU -->
          <!-- add-0 -->
          <g id="add-0" transform = "translate(300, 57)">
            <polygon points = "0,25 0,0 40,19 40,51 0,70 0,45 13,35" transform = "scale(1.75)" class = "component"/>

            <text x = "46"  y = "62" class = "label"> Add </text>
            <text x = "-60" y = "95" class = "label"> 4 </text>
          </g>

          <!-- add-1 -->
          <g id="add-1" transform = "translate(1280, 130)">
            <polygon points = "0,25 0,0 40,19 40,51 0,70 0,45 13,35" transform = "scale(2.10)" class = "component"/>

            <text x = "55" y = "75" class = "label"> Add </text>
            <text id = "add-1-1" x = "55" y = "70" class = "instruction"></text>
            <text id = "add-1-2" x = "55" y = "100" class = "instruction"></text>
          </g>

          <!-- add-2 -->
          <g id="add-2" transform = "translate(1190, 540)">
            <polygon points = "0,25 0,0 40,19 40,51 0,70 0,45 13,35" transform = "scale(2.5)" class = "component"/>

            <text x = "60" y = "90" class = "label"> ALU </text>
            
            <text x = "50" y = "65" class = "mem-control-label"> Zero </text>
            
            <text id = "alu-option-value" x = "65" y = "160" class = "mem-control-label"></text>
          </g>

          <!-- End Alu -->

          <!-- control -->
          <g id="control" transform = "translate(640, 335)">
              <ellipse cx = "70" cy = "50" rx = "50" ry = "120" class = "control-component" />
              
              <text x = "70" y = "50" class = "control-label"> Control </text>
              
              <text x = "140" y = "-65" class = "mem-control-label"> Reg2Loc </text>
              <text x = "140" y = "-40" class = "mem-control-label"> Uncondbranch </text>
              <text x = "140" y = "-15" class = "mem-control-label"> Branch </text>
              <text x = "140" y = "10"  class = "mem-control-label"> MemRead </text>
              <text x = "140" y = "35"  class = "mem-control-label"> MemtoReg </text>
              <text x = "140" y = "60"  class = "mem-control-label"> ALUOp </text>
              <text x = "140" y = "85"  class = "mem-control-label"> MemWrite </text>
              <text x = "140" y = "110" class = "mem-control-label"> ALUSrc </text>
              <text x = "140" y = "135" class = "mem-control-label"> RegWrite </text>
          </g>

          <!-- shift-left-2 -->
          <g id="shift-left-2" transform = "translate(1150, 250)">
            <circle cx = "0" cy = "0" r = "40" class = "component"/>
            
            <text x = "0" y = "-10" class = "label"> Shift </text>
            <text x = "0" y = "10"  class = "label"> left 2 </text>
            <text id="shift-left-2-text" x = "0" y = "10"  class = "instruction"> </text>
          </g>

          <!-- sign-extend -->
          <g id="sign-extend" transform = "translate(880, 840)">
            <circle cx = "0" cy = "0" r = "50" class = "component"/>
            
            <text x = "0" y = "-10" class = "label"> Sign- </text>
            <text x = "0" y = "10"  class = "label"> extend </text>
            
            <text x = "-100" y = "-20" class = "mem-label"> 32 </text> 
            <text x = "-90" y = "0"   class = "label"> ‚ï≤ </text> 
            <text x = "70"   y = "-20" class = "mem-label"> 64 </text> 
            <text x = "80"   y = "0"   class = "label"> ‚ï≤ </text>
            
            <text id="sign-extend-text" x = "0" y = "30"  class = "instruction"></text>
            
          </g>

          <!-- ALU-control -->
          <g id="ALU-control" transform = "translate(1130, 860)">
            <ellipse cx = "0" cy = "0" rx = "50" ry = "70" class = "control-component" />

            <text x = "0" y = "-10" class = "control-label"> ALU </text>
            <text x = "0" y = "10"  class = "control-label"> Control </text>

            <text id = "alu-control-aluop-value" x = "-75" y = "-5" class = "mem-control-label"></text>
          </g>

          <!-- mux-0 -->
          <g id="mux-0" transform = "translate(1580, 100)">
            <rect x = "0"  y = "0" width = "40" height = "120" rx = "20" ry = "20" class = "component"/>
            
            <path id = "mux-0-0-selected" d = "M0,20 A20,20 0 0 1 20,0 A20,20 0 0 1 40,20 L40,60 L0,60 Z" class = "mux-select-0"/>
            <path id = "mux-0-1-selected" d = "M0,60 L40,60 L40,100 A20,20 0 0 1 20,120 A20,20 0 0 1 0,100 Z" class = "mux-select-1"/>
            
            <text x = "14" y = "20"  class = "mem-label"> 0 </text>
            <text x = "20" y = "40"  class = "label">     M </text>
            <text x = "20" y = "60"  class = "label">     u </text>
            <text x = "20" y = "80"  class = "label">     x </text>
            <text x = "14" y = "110" class = "mem-label"> 1 </text>

            <text id = "mux-0-value" x = "5" y = "140" class = "mem-control-label"></text>
          </g>

          <!-- mux-1 -->
          <g id="mux-1" transform = "translate(670, 555)">
            <rect x = "0"  y = "0" width = "40" height = "100" rx = "20" ry = "20" class = "component"/>

            <path id = "mux-1-0-selected" d = "M0,20 A20,20 0 0 1 20,0 A20,20 0 0 1 40,20 L40,45 L0,45 Z" class = "mux-select-0"/>
            <path id = "mux-1-1-selected" d = "M0,45 L40,45 L40,80 A20,20 0 0 1 20,100 A20,20 0 0 1 0,80 Z" class = "mux-select-1"/>
            
            <text x = "14" y = "20" class = "mem-label"> 0 </text>
            <text x = "20" y = "35" class = "label">     M </text>
            <text x = "20" y = "50" class = "label">     u </text>
            <text x = "20" y = "65" class = "label">     x </text>
            <text x = "14" y = "90" class = "mem-label"> 1 </text>
            
            <text id = "mux-1-value" x = "5" y = "190" class = "mem-control-label"></text>

            <!-- HQH add -->
            <rect id = "mux-1-0-background" x = "0"  y = "0" width = "40" height = "100" rx = "20" ry = "20" class = "component" style="display: none; fill:aqua"/>
            <!-- <rect id = "mux-1-1-background" x = "0" y = "0"> </rect> -->
            <text id="mux-1-0" x = "10"  y = "35" class="instruction"></text>
            <text id="mux-1-1" x = "10"  y = "65" class="instruction"></text>

          </g>
          
          <!-- mux-2 -->
          <g id="mux-2" transform = "translate(1070, 630)">
            <rect x = "0"  y = "0" width = "40" height = "100" rx = "20" ry = "20" class = "component"/>
            
            <path id = "mux-2-0-selected" d = "M0,20 A20,20 0 0 1 20,0 A20,20 0 0 1 40,20 L40,50 L0,50 Z" class = "mux-select-0"/>
            <path id = "mux-2-1-selected" d = "M0,50 L40,50 L40,80 A20,20 0 0 1 20,100 A20,20 0 0 1 0,80 Z" class = "mux-select-1"/>

            <text x = "14" y = "20" class = "mem-label"> 0 </text>
            <text x = "20" y = "35" class = "label">     M </text>
            <text x = "20" y = "50" class = "label">     u </text>
            <text x = "20" y = "65" class = "label">     x </text>
            <text x = "14" y = "90" class = "mem-label"> 1 </text>

            <text id="mux-2-0" x = "14"  y = "20" class="instruction"></text>
            <text id="mux-2-1" x = "14"  y = "90" class="instruction"></text>

            <text id = "mux-2-value" x = "5" y = "-5" class = "mem-control-label"></text>
          </g>
          
          <!-- mux-3 -->
          <g id="mux-3" transform="translate(1690, 665)">
            <rect x = "0"  y = "0" width = "40" height = "100" rx = "20" ry = "20" class = "component"/>
            
            <path id = "mux-3-0-selected" d = "M0,50 L40,50 L40,80 A20,20 0 0 1 20,100 A20,20 0 0 1 0,80 Z" class = "mux-select-0"/>
            <path id = "mux-3-1-selected" d = "M0,20 A20,20 0 0 1 20,0 A20,20 0 0 1 40,20 L40,50 L0,50 Z" class = "mux-select-1"/>

            <text x = "14" y = "20" class = "mem-label"> 1 </text>
            <text x = "20" y = "35" class = "label">     M </text>
            <text x = "20" y = "50" class = "label">     u </text>
            <text x = "20" y = "65" class = "label">     x </text>
            <text x = "14" y = "90" class = "mem-label"> 0 </text>

            <text id = "mux-3-value" x = "5" y = "-5" class = "mem-control-label"></text>
          </g>

          <!-- AND gate -->
          <g id="and-gate" transform="translate(1350, 450)">
            <path d="M0,0 L40,0 A40,50 0 0,1 40,100 L0,100 Z" stroke="deepskyblue" class="control-component" />
            
            <text id = "and-gate-input1-value" x = "-15" y = "25" class = "mem-control-label"></text>
            <text id = "and-gate-input2-value" x = "-15" y = "90" class = "mem-control-label"></text>
          </g>

          <!-- OR gate -->
          <g id="or-gate" transform="translate(1470, 230)">
            <path d="M0,0 Q40,40 0,100 Q50,100 80,50 Q50,0 0,0" stroke="deepskyblue" class="control-component" />

            <text id = "or-gate-input1-value" x = "-5" y = "25" class = "mem-control-label"></text>
            <text id = "or-gate-input2-value" x = "-5" y = "80" class = "mem-control-label"></text>
          </g>  
        </g> <!-- End Components Layer -->
      </g>

      <g id = "selected-component">
        <defs>
          <marker id = "arrow" markerWidth = "4" markerHeight = "4" refX = "2" refY = "2" orient = "auto">
            <path d = "M0,0 L4,2 L0,4 z" fill = "context-stroke" />
          </marker>
        </defs>

        <g id="instruction-memory-selected" transform = "translate(-500, -500)">
          <rect x = "-10" y = "-10" width = "147" height = "217" class = "selected-component" />
          <rect width = "130" height = "200" class = "component" />

          <text x = "65" y = "165" class = "label"> Instruction </text>
          <text x = "65" y = "185" class = "label"> memory</text>
      
          <text x = "5"  y = "20"  class = "mem-label"> Read </text>
          <text x = "5"  y = "40"  class = "mem-label"> address </text>
          <text id = "instruction-memory-read-address-value" x = "5"  y = "55" class = "component-value"> 0x12 </text>
          
          <text x = "35" y = "95"  class = "mem-label"> Instruction </text> 
          <text x = "75" y = "115" class = "mem-label"> [31-0] </text>
          <text id = "instruction-memory-instruction-[31-0]-value" x = "42"  y = "135" class = "component-value"> 0x00000000 </text>
        </g>

        <g id="register-selected" transform = "translate(-500, -500)">
          <rect x = "-10" y = "-10" width = "187" height = "237" class = "selected-component" />
          <rect width = "170" height = "220" class = "component" />

          <text x = "115" y = "205" class = "label"> Registers </text>

          <text x = "5"   y = "20"  class = "mem-label"> Read </text>
          <text x = "5"   y = "40"  class = "mem-label"> register 1 </text>
          <text id = "register-read-register-1-value" x = "5"  y = "55" class = "component-value"> 00000 </text>

          <text x = "5"   y = "75"  class = "mem-label"> Read </text>
          <text x = "5"   y = "95"  class = "mem-label"> register 2 </text>
          <text id = "register-read-register-2-value" x = "5"  y = "110" class = "component-value"> 00000 </text>
    
          <text x = "5"   y = "130" class = "mem-label"> Write </text>
          <text x = "5"   y = "150" class = "mem-label"> register </text>
          <text id = "register-write-register-value" x = "5"  y = "165" class = "component-value"> 00000 </text>
            
          <text x = "5"   y = "182" class = "mem-label"> Write </text>
          <text x = "5"   y = "202" class = "mem-label"> data </text>
          <text id = "register-write-data-value" x = "5"  y = "215" class = "component-value"> 0x00 </text>

          <text x = "115" y = "40"  class = "mem-label"> Read </text>
          <text x = "110" y = "60"  class = "mem-label"> data 1 </text>
          <text id = "register-read-data-1-value" x = "130"  y = "75" class = "component-value"> 0x00 </text>
          
          <text x = "115" y = "130" class = "mem-label"> Read </text>
          <text x = "110" y = "150" class = "mem-label"> data 2 </text>
          <text id = "register-read-data-2-value" x = "130"  y = "165" class = "component-value"> 0x00 </text>
        </g>

        <g id="data-memory-selected" transform = "translate(-500, -500)">
          <rect x = "-10" y = "-10" width = "157" height = "217" class = "selected-component" />
          <rect width = "140" height = "200" class = "component" />

          <text x = "110" y = "165" class = "label"> Data </text>
          <text x = "90"  y = "185" class = "label"> memory </text>

          <text x = "5"   y = "45"  class = "mem-label"> Address </text>
          <text id = "data-memory-address-value" x = "5"  y = "60" class = "component-value"> 0x00 </text>

          <text x = "5"   y = "155" class = "mem-label"> Write </text>
          <text x = "5"   y = "175" class = "mem-label"> data </text>
          <text id = "data-memory-write-data-value" x = "5"  y = "190" class = "component-value"> 0x00 </text>

          <text x = "85"  y = "65"  class = "mem-label"> Read </text>
          <text x = "95"  y = "85"  class = "mem-label"> data </text>
          <text id = "data-read-data-value" x = "100"  y = "100" class = "component-value"> 0x00 </text>
        </g>

        <g id="add-2-selected" transform = "translate(-500, -500)">
          <rect x = "-10" y = "-60" width = "117" height = "243" class = "selected-component" />
          <path d = "M50,25 L50,-20" class = "signal-line" marker-end = "url(#arrow)"/> 

          <polygon points = "0,25 0,0 40,19 40,51 0,70 0,45 13,35" transform = "scale(2.5)" class = "component"/>

          <text x = "60" y = "90" class = "label"> ALU </text>
          
          <text id = "add-2-input-upper-value" x = "5"  y = "40" class = "component-value"> 0x00 </text>
          <text id = "add-2-input-lower-value" x = "5"  y = "145" class = "component-value"> 0x00 </text>

          <text id = "add-2-output-value" x = "65"  y = "115" class = "component-value"> 0x00 </text>
          
          <rect x = "0"  y = "-50" width = "25" height = "25" class = "component"/>
          <text x = "12"  y = "-35" class = "label">N</text>
          <text id = "add-2-n-value" x = "8"  y = "-10" class = "component-value"> 0 </text>

          <rect x = "25" y = "-50" width = "25" height = "25" class = "component"/>
          <text x = "37"  y = "-35" class = "label">Z</text>
          <text id = "add-2-z-value" x = "33"  y = "-10" class = "component-value"> 0 </text>
          
          <rect x = "50" y = "-50" width = "25" height = "25" class = "component"/>
          <text x = "62"  y = "-35" class = "label">C</text>
          <text id = "add-2-z-value" x = "58"  y = "-10" class = "component-value"> 0 </text>
          
          <rect x = "75" y = "-50" width = "25" height = "25" class = "component"/>
          <text x = "87"  y = "-35" class = "label">V</text>
          <text id = "add-2-z-value" x = "83"  y = "-10" class = "component-value"> 0 </text>
        </g>

        <g id="shift-left-2-selected" transform = "translate(-500, -500)">
          <rect x = "-200" y = "-50" width = "400" height = "95" class = "selected-component"/>
          <circle cx = "0" cy = "0" r = "40" class = "component"/>
          
          <text x = "0" y = "-10" class = "label"> Shift </text>
          <text x = "0" y = "10"  class = "label"> left 2 </text>
          
          <path d = "M-190,0 L-45,0" class = "signal-line" marker-end = "url(#arrow)"/>
          <text id = "shift-left-2-input-value" x = "-192"  y = "20" class = "component-value"> 0x0000000000000000 </text>
          
          <path d = "M40,0 L185,0" class = "signal-line" marker-end = "url(#arrow)"/>
          <text id = "shift-left-2-output-value" x = "42"  y = "20" class = "component-value"> 0x0000000000000000 </text>
        </g>

        <g id="sign-extend-selected" transform = "translate(-500, -500)">
          <rect x = "-200" y = "-50" width = "400" height = "95" class = "selected-component"/>
          <circle cx = "0" cy = "0" r = "40" class = "component"/>
          
          <text x = "0" y = "-10" class = "label"> Sign- </text>
          <text x = "0" y = "10"  class = "label"> extend </text>

          <path d = "M-190,0 L-45,0" class = "signal-line" marker-end = "url(#arrow)"/>
          <text id = "sign-extend-input-value" x = "-125"  y = "27" class = "component-value"> 0x00000000 </text>
          
          <path d = "M40,0 L185,0" class = "signal-line" marker-end = "url(#arrow)"/>
          <text id = "sign-extend-output-value" x = "42"  y = "27" class = "component-value"> 0x0000000000000000 </text>

          <text x = "-100" y = "-20" class = "mem-label"> 32 </text> 
          <text x = "-90" y = "0"   class = "label"> ‚ï≤ </text> 
          <text x = "70"   y = "-20" class = "mem-label"> 64 </text> 
          <text x = "80"   y = "0"   class = "label"> ‚ï≤ </text>
        </g>
      </g>

      </svg>

      <button class = "frame-button" id = "fullscreen-btn" title = "Toggle fullscreen"></button>
      <button class = "start-button" id = "start-animation" title = "Start animation">‚ñ∂</button>
      <button class = "stop-button"  id = "stop-animation" title = "Stop animation">‚è∫</button>

      <div class = "command-box">
        <p id = "assembly-instruction"> </p>
        <p id = "machine-language-instruction">ADD X9, X20, X21</p>
      </div>
    </div>

    <div class="range-container">
      <input type="range" id="range-slider" class="range-slider" min="0" max="100" value="50">
      <label for="range-slider" class="range-label">
        Speed: <span id="range-value" class="range-value">50</span>ms
      </label>
    </div>
  </div>
  
  <div class = "codeBox">
    <h2>Code</h2>
    
    <form id = "codeForm" >
      <!-- Add id="instructionCode" to the textarea -->
      <div class = "code-editor">
        <div class = "line-numbers" id = "lineNumbers"> 1 </div>
        <textarea class = "instructionCode" id = "instructionCode" name="message" rows="35" cols="30" placeholder="Enter LEGv8 code here, one instruction per line...">
          ADD X9, X20, X21
          ADD X9, X20, X21
          ADD X9, X20, X21
          ADD X9, X20, X21
          ADD X9, X20, X21
          
        </textarea>
      </div>
      <button class = "button" id = "parseInstructions">Parse Instructions</button>
    </form>
  </div>
</div>

<div class = "outputContainer">
  <div class = "registersBox">
    <h2>Flags</h2>
    
    <table class = "parsedOutputTable">
      <thead>
        <tr>
          <th>N</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
        </tr>
      </tbody>
    </table>
    <table class = "parsedOutputTable">
      <thead>
        <tr>
          <th>Z</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
        </tr>
      </tbody>
    </table>
    <table class = "parsedOutputTable">
      <thead>
        <tr>
          <th>V</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
        </tr>
      </tbody>
    </table>
    <table class = "parsedOutputTable">
      <thead>
        <tr>
          <th>C</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
        </tr>
      </tbody>
    </table>
  </div>

  <div class = "registersBox">
    <h2>Registers</h2>

    <table class = "parsedOutputTable">
      <thead>
        <tr>
          <th>X00</th>
          <th>X01</th>
          <th>X02</th>
          <th>X03</th>
          <th>X04</th>
          <th>X05</th>
          <th>X06</th>
          <th>X07</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0x00000000</th>
          <th>0x00000000</th>
          <th>0x00000000</th>
          <th>0x00000000</th>
          <th>0x00000000</th>
          <th>0x00000000</th>
          <th>0x00000000</th>
          <th>0x00000000</th>
        </tr>
      </tbody>
    </table>
    <table class = "parsedOutputTable">
      <thead>
        <tr>
          <th>X08</th>
          <th>X09</th>
          <th>X10</th>
          <th>X11</th>
          <th>X12</th>
          <th>X13</th>
          <th>X14</th>
          <th>X15</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0x00000000</th>
          <th>0x00000000</th>
          <th>0x00000000</th>
          <th>0x00000000</th>
          <th>0x00000000</th>
          <th>0x00000000</th>
          <th>0x00000000</th>
          <th>0x00000000</th>
        </tr>
      </tbody>
    </table>
    <table class = "parsedOutputTable">
      <thead>
        <tr>
          <th>X16</th>
          <th>X17</th>
          <th>X18</th>
          <th>X19</th>
          <th>X20</th>
          <th>X21</th>
          <th>X22</th>
          <th>X23</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0x00000000</th>
          <th>0x00000000</th>
          <th>0x00000000</th>
          <th>0x00000000</th>
          <th>0x00000000</th>
          <th>0x00000000</th>
          <th>0x00000000</th>
          <th>0x00000000</th>
        </tr>
      </tbody>
    </table>
    <table class = "parsedOutputTable">
      <thead>
        <tr>
          <th>X24</th>
          <th>X25</th>
          <th>X26</th>
          <th>X27</th>
          <th>SP</th>
          <th>FP</th>
          <th>LR</th>
          <th>XZR</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0x00000000</th>
          <th>0x00000000</th>
          <th>0x00000000</th>
          <th>0x00000000</th>
          <th>0x00000000</th>
          <th>0x00000000</th>
          <th>0x00000000</th>
          <th>0x00000000</th>
        </tr>
      </tbody>
    </table>
  </div>

  <div class = "parsedOutputBox">
    <h2>Parsed Output</h2>
    
    <!-- Mu·ªën hi·ªÉn th·ªã l·∫°i parsedOutput thu·∫ßn th√¨ ph·∫£i v√†o script.js m·ªü code l·∫°i nha -->
    <!-- <pre id="parsedOutput" rows="10" cols="50"></pre> -->
    
    <table class = "parsedOutputTable">
      <thead>
        <tr>
          <th>Line</th>
          <th>Mnemonic</th>
          <th>Type</th>
          <th>Rd</th>
          <th>Rn</th>
          <th>Rm</th>
          <th>Error</th>
        </tr>
      </thead>
      <tbody id = "parsedOutputTable">
      </tbody>
    </table>
  </div>
</div>
  
<script type="module" src="./Scripts/script.js"></script>

<div class="footer">
  Author: 23120015 - 23120304 (HCMUS - Honor Program) ¬© 2025 LEGv8 Visual Simulator. All rights reserved.
</div>

</body>
</html>